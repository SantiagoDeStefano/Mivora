openapi: 3.0.4
info:
  title: Twitter clone TypeScript - 2025
  description: |-
    This API provides the backend services for a social media platform similar to Twitter.  
    It includes features for user authentication and profile management, media upload and streaming, 
    tweet creation and interaction, search functionality, and real-time conversations.  
    The system is built with scalability, security, and modern REST API design principles in mind.
    Some useful links:
    - [The Twitter's clone repository](https://github.com/SantiagoDeStefano/Twitter)
    - [The source API definition for the Twitter's clone](https://github.com/SantiagoDeStefano/Twitter/blob/master/twitter-swagger.yaml)
  contact:
    email: ngpham.2807@gmail.com
  version: 0.0.1
servers:
  - url: http://localhost:4000
    description: Local server
tags:
  - name: users
    description: Everything about Users's requests
  - name: events
    description: Everything about Event's requests
paths:
  /users/login:
    post:
      tags:
        - users
      summary: Logs user into the system
      operationId: loginUser
      requestBody:
        description: The user login credentials
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginBody'
      responses:
        '200':
          description: Login successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Login successfully
                  data:
                    $ref: '#/components/schemas/AuthenticateSuccessfully'

        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Validation error'
                  errors:
                    type: object
                    properties:
                      email:
                        type: object
                        properties:
                          type:
                            type: string
                            example: 'field'
                          value:
                            type: string
                            example: 'Non-existent-Email@gmail.com'
                          msg:
                            type: string
                            example: 'Email or password is incorrect'
                          path:
                            type: string
                            example: 'email'
                          location:
                            type: string
                            example: 'body'
      security: []
  /users/register:
    post:
      tags:
        - users
      summary: Registers a new user
      operationId: registerUser
      requestBody:
        description: The user registration credentials
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterBody'
      responses:
        '200':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: User registered successfully
                  result:
                    type: object
                    properties:
                      access_token:
                        type: string
                        example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MCwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc1MjU4OTk2Nn0.N0NpQZDcu-gMpXLApVimd0etDPJoz7cp6ksGsdbP1WA'
                      refresh_token:
                        type: string
                        example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc2MTIyOTkzNn0.C4W_Me1Di-owhrpj1VJ6j-ImoPtWMy6QMPT6R-uJ4a8'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Validation error'
                  errors:
                    type: object
                    properties:
                      email:
                        type: object
                        properties:
                          type:
                            type: string
                            example: 'field'
                          value:
                            type: string
                            example: 'TNTV@gmail.com'
                          msg:
                            type: string
                            example: 'Email already exists'
                          path:
                            type: string
                            example: 'email'
                          location:
                            type: string
                            example: 'body'
  /users/refresh-token:
    post:
      tags:
        - users
      summary: Refreshes the access token
      operationId: refreshToken
      requestBody:
        description: The refresh token to be used for generating a new access token
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc2MTIyOTkzNn0.C4W_Me1Di-owhrpj1VJ6j-ImoPtWMy6QMPT6R-uJ4a8'
      responses:
        '200':
          description: Get new access token
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: New tokens returned successfully
                  result:
                    $ref: '#/components/schemas/AuthenticateSuccessfully'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Used refresh token or does not exist'
  /users/logout:
    post:
      tags:
        - users
      summary: Logs out the current user
      operationId: logoutUser
      requestBody:
        description: The logout request does not require a body
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0Y2UzN2Q4MzY0MmNlM2ZlMmMxZWIzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTMyODUwNDQsImV4cCI6MTc1NDU4MTA0NH0.8iQbK7lvM7_KqypTvRYFsiDTAx2UTtpxJG79p777XU4'
              required:
                - refresh_token
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User logged out successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Logout successfully'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Used refresh token or does not exist'
  /users/me:
    get:
      tags:
        - users
      summary: Get current user's information
      operationId: getCurrentUser
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Current user information retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get profile successfully
                  result:
                    $ref: '#/components/schemas/UserProfile'
    patch:
      tags:
        - users
      summary: Update current user's information
      operationId: updateCurrentUser
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'

      responses:
        '200':
          description: Current user information retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Update me successfully
                  result:
                    $ref: '#/components/schemas/UserProfile'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      role:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          value:
                            type: string
                            example: organizer
                          msg:
                            type: string
                            example: User already have this role
                          path:
                            type: string
                            example: role
                          location:
                            type: string
                            example: body

  /events:
    post:
      tags:
        - events
      summary: Create a new event
      operationId: createEvent
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Event'
      responses:
        '200':
          description: Event created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event created successfully
                  result:
                    $ref: '#/components/schemas/Event'
        '403':
          description: Event creator must be organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Event creator must be organizer'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Access token is required'
components:
  schemas:
    LoginBody:
      type: object
      properties:
        email:
          type: string
          example: TNTV@gmail.com
        password:
          type: string
          example: qiefhuasdsa@23irQ
    RegisterBody:
      type: object
      properties:
        name:
          type: string
          example: 'Lam Uyen Phuong'
        email:
          type: string
          example: 'TNTV1@gmail.com@gmail.com'
        password:
          type: string
          example: 'qiefhuasdsa@23irQ'
        confirm_password:
          type: string
          example: 'qiefhuasdsa@23irQ'
    AuthenticateSuccessfully:
      type: object
      properties:
        result:
          type: object
          properties:
            access_token:
              type: string
              example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MCwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc1MjU4OTk2Nn0.N0NpQZDcu-gMpXLApVimd0etDPJoz7cp6ksGsdbP1WA'
            refresh_token:
              type: string
              example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc2MTIyOTkzNn0.C4W_Me1Di-owhrpj1VJ6j-ImoPtWMy6QMPT6R-uJ4a8'
    UserProfile:
      type: object
      properties:
        name:
          type: string
          example: Pham Khoi Nguyen
        email:
          type: string
          format: email
          example: TNTV_6@gmail.com
        avatar_url:
          type: string
          example: example_avt_url
        role:
          type: array
          items:
            type: string
            enum: [attendee, organizer]
          example:
            - attendee
            - organizer
    UpdateUserRequest:
      type: object
      required: [name, avatar_url, role]
      properties:
        name:
          type: string
          example: Pham Khoi Nguyen
        avatar_url:
          type: string
          example: example_avt_url
        role:
          type: string
          enum: [attendee, organizer]
          example: organizer
    Event:
      type: object
      required:
        - title
        - location_text
        - start_at
        - end_at
        - price_cents
        - capacity
      properties:
        organizer_id:
          type: string
          format: uuid
          example: 1a2b3c4d-5678-90ab-cdef-1234567890ab
        title:
          type: string
          example: Tech Innovation Summit 2025
        description:
          type: string
          example: A conference exploring emerging technologies and innovation trends.
        poster_url:
          type: string
          format: uri
          example: https://example.com/posters/tech-summit-2025.jpg
        location_text:
          type: string
          example: 123 Main Street, San Francisco, CA
        start_at:
          type: string
          format: date-time
          example: 2025-11-20T09:00:00Z
        end_at:
          type: string
          format: date-time
          example: 2025-11-20T17:00:00Z
        price_cents:
          type: integer
          example: 2500
        checked_in:
          type: integer
          example: 0
        capacity:
          type: integer
          example: 150
        status:
          type: string
          enum: [draft, published, canceled]
          example: draft
    UserVerifyStatus:
      type: integer
      description: |
        User verification status:
        - 0 = Unverified
        - 1 = Verified
        - 2 = Banned
      enum: [0, 1, 2]
    MediaType:
      type: integer
      description: |
        Media type:
        - 0 = Image
        - 1 = Video
        - 2 = HLS
      enum: [0, 1, 2]
    EncodingStatus:
      type: integer
      description: |
        Video encoding status:
        - 0 = Pending
        - 1 = Processing
        - 2 = Successfully
        - 3 = Failed
      enum: [0, 1, 2, 3]
    TweetType:
      type: integer
      description: |
        Tweet type:
        - 0 = Tweet
        - 1 = Retweet
        - 2 = Comment
        - 3 = QuoteTweet
      enum: [0, 1, 2, 3]
    TweetAudience:
      type: integer
      description: |
        Audience visibility setting:
        - 0 = Everyone
        - 1 = TwitterCircle
      enum: [0, 1]
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Use the `Bearer` scheme to authenticate requests. Include the token in the `Authorization` header as follows:
        ```
        Authorization: Bearer <your_token>
        ```
