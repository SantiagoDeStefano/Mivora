openapi: 3.0.4
info:
  title: Mivora - 2025
  description: |-
    This OpenAPI spec describes the backend API for Mivora, a platform that handles users, events, tickets, and real-time event messaging. It includes full user account flows such as registration, login, logout, token refresh, profile updates, avatar uploads, email verification, and password-reset procedures. Event organizers can create, update, publish, cancel, and manage event posters, while both organizers and attendees can send and fetch event messages. Users can browse published events, view details, and book tickets. The ticketing system supports booking, listing with filters, retrieving individual tickets, canceling or checking in tickets, and QR-code-based scanning. All sensitive and user-specific operations use JWT bearer authentication, and list endpoints follow a consistent pagination pattern.
    some useful links:
    - [The Mivora repository](https://github.com/SantiagoDeStefano/Mivora)
    - [The source API definition for Mivora](https://github.com/SantiagoDeStefano/Mivora/blob/main/Backend/MivoraSwagger.yaml)

  version: 0.0.1
servers:
  - url: /
    description: Same host as Swagger
  - url: http://47.129.118.52:4000
    description: EC2 server
  - url: http://localhost:4000
    description: Local server
  - url: http://26.35.82.76:4000
    description: LAN server
  - url: https://khoinguyenpham.name.vn
    description: Production api server
tags:
  - name: users
    description: Everything about Users's requests
  - name: events
    description: Everything about Event's requests
  - name: ticket
    description: Everything about Ticket's requests
paths:
  /api/v1/users/login:
    post:
      tags:
        - users
      summary: Logs user into the system
      operationId: loginUser
      requestBody:
        description: The user login credentials
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginBody'
      responses:
        '200':
          description: Login successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Login successfully
                  data:
                    $ref: '#/components/schemas/AuthenticateSuccessfully'

        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Validation error'
                  errors:
                    type: object
                    properties:
                      email:
                        type: object
                        properties:
                          type:
                            type: string
                            example: 'field'
                          value:
                            type: string
                            example: 'Non-existent-Email@gmail.com'
                          msg:
                            type: string
                            example: 'Email or password is incorrect'
                          path:
                            type: string
                            example: 'email'
                          location:
                            type: string
                            example: 'body'
      security: []
  /api/v1/users/register:
    post:
      tags:
        - users
      summary: Registers a new user
      operationId: registerUser
      requestBody:
        description: The user registration credentials
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterBody'
      responses:
        '200':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: User registered successfully
                  result:
                    type: object
                    properties:
                      access_token:
                        type: string
                        example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MCwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc1MjU4OTk2Nn0.N0NpQZDcu-gMpXLApVimd0etDPJoz7cp6ksGsdbP1WA'
                      refresh_token:
                        type: string
                        example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc2MTIyOTkzNn0.C4W_Me1Di-owhrpj1VJ6j-ImoPtWMy6QMPT6R-uJ4a8'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Validation error'
                  errors:
                    type: object
                    properties:
                      email:
                        type: object
                        properties:
                          type:
                            type: string
                            example: 'field'
                          value:
                            type: string
                            example: 'TNTV@gmail.com'
                          msg:
                            type: string
                            example: 'Email already exists'
                          path:
                            type: string
                            example: 'email'
                          location:
                            type: string
                            example: 'body'
  /api/v1/users/refresh-token:
    post:
      tags:
        - users
      summary: Refreshes the access token
      operationId: refreshToken
      requestBody:
        description: The refresh token to be used for generating a new access token
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc2MTIyOTkzNn0.C4W_Me1Di-owhrpj1VJ6j-ImoPtWMy6QMPT6R-uJ4a8'
      responses:
        '200':
          description: Get new access token
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: New tokens returned successfully
                  result:
                    $ref: '#/components/schemas/AuthenticateSuccessfully'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Used refresh token or does not exist'
  /api/v1/users/logout:
    post:
      tags:
        - users
      summary: Logs out the current user
      operationId: logoutUser
      requestBody:
        description: The logout request does not require a body
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0Y2UzN2Q4MzY0MmNlM2ZlMmMxZWIzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTMyODUwNDQsImV4cCI6MTc1NDU4MTA0NH0.8iQbK7lvM7_KqypTvRYFsiDTAx2UTtpxJG79p777XU4'
              required:
                - refresh_token
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User logged out successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Logout successfully'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Used refresh token or does not exist'
  /api/v1/users/me:
    get:
      tags:
        - users
      summary: Get current user's information
      operationId: getCurrentUser
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Current user information retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get profile successfully
                  result:
                    $ref: '#/components/schemas/UserProfile'
    patch:
      tags:
        - users
      summary: Update current user's information
      operationId: updateCurrentUser
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'

      responses:
        '200':
          description: Current user information retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Update me successfully
                  result:
                    $ref: '#/components/schemas/UserProfile'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      role:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          value:
                            type: string
                            example: organizer
                          msg:
                            type: string
                            example: User must be verified to be organizer
                          path:
                            type: string
                            example: role
                          location:
                            type: string
                            example: body
  /api/v1/users/me/avatar:
    put:
      tags:
        - users
      summary: Update current user's avatar
      operationId: updateUserAvatar
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                image:
                  type: string
                  format: binary
      responses:
        '200':
          description: User avatar updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Avatar updated successfully
                  result:
                    $ref: '#/components/schemas/UserProfile'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      role:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          value:
                            example: null
                          msg:
                            type: string
                            example: Image type is not valid
                          path:
                            type: string
                            example: image
                          location:
                            type: string
                            example: files
  /api/v1/users/me/email-verification:
    post:
      tags:
        - users
      summary: Send email verification to current user
      operationId: sendEmailVerification
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Verification email sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Check your email for verification link
        '409':
          description: User is already verified
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Email already verified
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Access token is required'
  /api/v1/users/verify-email:
    post:
      tags:
        - users
      summary: Verify user's email with token
      operationId: verifyUserEmail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email_verify_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNGI3ZDJhNWMtMjk2ZS00ODAwLWIxOWQtNTEzY2JkMWUxNDEwIiwidmVyaWZ5IjoidW52ZXJpZmllZCIsInRva2VuX3R5cGUiOjMsImlhdCI6MTc2NTAxNTU3NCwiZXhwIjoxNzY1MTAxOTc0fQ.hzi2bkjdYr2wDN-r_uPohUoJgJ0drayfc8TzlGrzsZI'
      responses:
        '200':
          description: Email verified successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Email verified successfully
                  result:
                    type: object
                    properties:
                      access_token:
                        type: string
                        example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNGI3ZDJhNWMtMjk2ZS00ODAwLWIxOWQtNTEzY2JkMWUxNDEwIiwidmVyaWZ5IjoidmVyaWZpZWQiLCJ0b2tlbl90eXBlIjowLCJpYXQiOjE3NjUwMTYxMTIsImV4cCI6MTc2NTAxODgxMn0.BCSWP6KUNrR2nG_9h9PWvLWOpGEVfHQ6ZaRZ4DxCD4g'
                      refresh_token:
                        type: string
                        example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNGI3ZDJhNWMtMjk2ZS00ODAwLWIxOWQtNTEzY2JkMWUxNDEwIiwidmVyaWZ5IjoidmVyaWZpZWQiLCJ0b2tlbl90eXBlIjoxLCJpYXQiOjE3NjUwMTYxMTIsImV4cCI6MTc2NjMxMjExMn0.e67JpJKuKsfr4DURghupc3icjPGLOHhnYlpQWHSOMjU'
        '401':
          description: Invalid email verification token
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid email verification token
  /api/v1/users/forgot-password:
    post:
      tags:
        - users
      summary: Send forgot password email to user
      operationId: sendForgotPasswordEmail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: TNTV10@gmail.com
      responses:
        '200':
          description: Forgot password email sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Check your email for password reset link
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Validation error'
                  errors:
                    type: object
                    properties:
                      email:
                        type: object
                        properties:
                          type:
                            type: string
                            example: 'field'
                          value:
                            type: string
                            example: 'Non-existent-Email@gmail.com'
                          msg:
                            type: string
                            example: 'User not found'
                          path:
                            type: string
                            example: 'email'
                          location:
                            type: string
                            example: 'body'
  /api/v1/users/verify-forgot-password-token:
    post:
      tags:
        - users
      summary: Verify forgot password token
      operationId: verifyForgotPasswordToken
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                forgot_password_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNGE2NDVjNmMtODEyNS00MTA5LWE2YzctMGE4MGNiZjM4ZjhlIiwidG9rZW5fdHlwZSI6MiwidmVyaWZ5IjoidmVyaWZpZWQiLCJpYXQiOjE3NjE1NzMxNjYsImV4cCI6MTc2MTU3NDA2Nn0.DyejkOFQcwuW5O3bTeAUtutBoxxwtVLcBjNgBFn7to0'
      responses:
        '200':
          description: Verify forgot password token successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Verify forgot password token successfully
        '401':
          description: Invalid signature
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid signature
  /api/v1/users/reset-password:
    post:
      tags:
        - users
      summary: Reset user's password
      operationId: resetUserPassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
                  example: Thaovy86.
                confirm_password:
                  type: string
                  example: Thaovy85.
                forgot_password_token:
                  type: string
                  example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiOWFhZWY1YTYtZjllYS00NThiLThlMzEtNThjZDlmYmQ3ZmE0IiwidG9rZW5fdHlwZSI6MiwidmVyaWZ5IjoidmVyaWZpZWQiLCJpYXQiOjE3NjUwMTY4MzQsImV4cCI6MTc2NTAxNzczNH0.RpkinTJJi3Ay5uXiilNGYOozckQAiMpYLI3X0FKk7Ec'
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Password reset successfully
        '401':
          description: Invalid forgot password token
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid forgot password token
  /api/v1/users/me/events:
    get:
      tags:
        - users
      summary: Get current user's events
      operationId: getMyEvents
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
          description: Number of items per page
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
          description: Page number
      responses:
        '200':
          description: Events retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Events retrieved successfully
                  result:
                    type: array
                    items:
                      $ref: '#/components/schemas/Event'
                    example:
                      events:
                        - id: e59fee5d-db78-4bcc-9074-d5bcd42ddfa0
                          title: Smart static intranet
                          description: >-
                            Volo ipsum vulticulus cohors teres. Cervus tantum amet advoco dicta
                            apparatus bestia concido sequi territo. Ventosus ascisco comminor
                            voluptate cado teneo.
                            Varius utpote peccatus patria tandem sint vigor turbo utpote atavus.
                            Tero blandior incidunt sordeo villa demens conqueror cunabula thesaurus
                            cometes. Auxilium demens vesper coniecto rem ater quo subvenio utpote
                            demoror.
                            Omnis animadverto sub ad cunae verto amicitia vero quibusdam
                            assumenda. Abeo vilicus angulus conatus ustulo unde titulus. Rem
                            contigo casso cattus tribuo templum terra.
                          poster_url: https://picsum.photos/seed/LuVSo/800/600?blur=3
                          location_text: Abeworth, Guatemala
                          start_at: 2025-12-11T01:58:08.075Z
                          end_at: 2025-12-11T07:58:08.075Z
                          price_cents: 13187
                          checked_in: 24
                          capacity: 83
                          status: draft
                          total_count: '108'
                          revenue_cents: 0

                        - id: d1f9bf07-3758-4b07-b655-87adeb8efccc
                          title: Sustainable regional intranet
                          description: >-
                            Virgo aranea sollers charisma acerbitas calcar ventito carcer. Aperiam
                            toties ager tametsi cohibeo sono labore auctus. Delicate auxilium ante.
                          poster_url: https://picsum.photos/seed/FS5AHgd1ng/800/600?grayscale&blur=1
                          location_text: Stammfort, Burundi
                          start_at: 2025-12-04T05:46:13.176Z
                          end_at: 2025-12-04T10:46:13.176Z
                          price_cents: 12508
                          checked_in: 17
                          capacity: 436
                          status: published
                          total_count: '108'
                          revenue_cents: 125008

                        - id: a8d29ecd-03ae-4b61-a98b-31bcc2f44c17
                          title: Organic heuristic moderator
                          description: >-
                            Alii suus deserunt curatio cicuta bibo thymbra velociter arbitro
                            undique. Ulciscor caterva alii. Tendo caritas thorax tabula avaritia
                            non alienus adulatio suppono pecus.
                          poster_url: https://picsum.photos/seed/br7m7jNSyI/800/600?grayscale&blur=10
                          location_text: New Ahmed, Andorra
                          start_at: 2025-12-30T16:36:52.278Z
                          end_at: 2025-12-30T18:36:52.278Z
                          price_cents: 19286
                          checked_in: 14
                          capacity: 365
                          status: published
                          total_count: '108'
                          revenue_cents: 0

        '403':
          description: Must be organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Must be organizer'
  /api/v1/users/me/events/{event_id}:
    get:
      tags:
        - users
      summary: Get current user's event details by ID
      operationId: getMyEventById
      security:
        - BearerAuth: []
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the event to retrieve details for
          example: d36974fe-b895-47e4-a6d0-0d126fbaa604
      responses:
        '200':
          description: Event retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event retrieved successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: 9a83ec0c-c4aa-4b4c-9d7a-b7a42dd163c8
                      title:
                        type: string
                        example: Persevering value-added array
                      description:
                        type: string
                        example: Creptio tantillus capitulus cena calco...
                      poster_url:
                        type: string
                        format: uri
                        example: https://picsum.photos/seed/lZqP2FB9PU/800/600?blur=8
                      location_text:
                        type: string
                        example: Osbornemouth, Gabon
                      start_at:
                        type: string
                        format: date-time
                        example: 2026-01-04T11:29:51.442Z
                      end_at:
                        type: string
                        format: date-time
                        example: 2026-01-04T16:29:51.442Z
                      price_cents:
                        type: integer
                        example: 45616
                      checked_in:
                        type: integer
                        example: 6
                      capacity:
                        type: integer
                        example: 368
                      status:
                        type: string
                        example: published
                      revenue_cents:
                        type: integer
                        example: 45616
        '403':
          description: Must be organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Current user is not event's organizer
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event not found
  /api/v1/users/me/tickets:
    get:
      tags:
        - users
      summary: Get all tickets of the current user
      operationId: getMyTickets
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          required: true
          schema:
            type: integer
            default: 20
          description: Number of items per page
        - name: page
          in: query
          required: true
          schema:
            type: integer
            default: 1
          description: Page number
        - name: status
          in: query
          required: false
          example: canceled
          schema:
            type: string
          description: Filter tickets by status (booked, canceled, checked_in)
        - name: q
          in: query
          required: false
          example: Implemented
          schema:
            type: string
          description: Search query for event title
      responses:
        '200':
          description: Get tickets successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get tickets successfully
                  result:
                    type: object
                    properties:
                      tickets:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                              example: d6de9a12-b3b1-4ea0-a1a3-d0823408a1ae
                            event_title:
                              type: string
                              example: Implemented leading edge strategy
                            event_status:
                              type: string
                              enum: [published, draft, canceled]
                              example: published
                            ticket_status:
                              type: string
                              enum: [booked, canceled, checked_in]
                              example: canceled
                            checked_in_at:
                              type: string
                              format: date-time
                              nullable: true
                              example: null
                            price_cents:
                              type: integer
                              example: 16583
                            total_count:
                              type: string
                              example: '1'
                            qr_code:
                              type: string
                              description: Base64 QR code image (data URL)
                              example: data:image/png;base64,<base64>
                      limit:
                        type: integer
                        example: 20
                      page:
                        type: integer
                        example: 1
                      total_page:
                        type: integer
                        example: 1
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      status:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          value:
                            type: string
                            example: canceledasda
                          msg:
                            type: string
                            example: Ticket status must be booked or checked in
                          path:
                            type: string
                            example: status
                          location:
                            type: string
                            example: query

  /api/v1/events:
    get:
      tags:
        - events
      summary: Get all published events
      operationId: getAllPublishedEvents
      parameters:
        - name: limit
          in: query
          required: true
          schema:
            type: integer
            default: 20
          description: Number of items per page
        - name: page
          in: query
          required: true
          schema:
            type: integer
            default: 1
          description: Page number
        - name: q
          in: query
          required: false
          example: Syn
          schema:
            type: string
          description: Search query for event title
      responses:
        '200':
          description: Get events successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get events successfully
                  result:
                    type: object
                    properties:
                      events:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                              example: 3b1bf6c6-4fa0-4026-95a2-be76908d1f5d
                            organizer_name:
                              type: string
                              example: Lam Uyen Phuong
                            title:
                              type: string
                              example: MEOMEOMEO
                            description:
                              type: string
                              example: tại sao lá cây lại có màu xanh
                            poster_url:
                              type: string
                              format: uri
                              example: https://example.com/poster.jpg
                            location_text:
                              type: string
                              example: 123 Main Street, San Francisco, CA
                            start_at:
                              type: string
                              format: date-time
                              example: 2025-12-06T14:03:00.000Z
                            end_at:
                              type: string
                              format: date-time
                              example: 2025-12-13T14:03:00.000Z
                            price_cents:
                              type: integer
                              example: 34300
                            checked_in:
                              type: integer
                              example: 0
                            capacity:
                              type: integer
                              example: 3434
                            status:
                              type: string
                              example: published
                            total_count:
                              type: string
                              example: '158'
                      limit:
                        type: integer
                        example: 20
                      page:
                        type: integer
                        example: 1
                      total_page:
                        type: integer
                        example: 8
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      q:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          value:
                            type: string
                            example: '0'
                          msg:
                            type: string
                            example: Search length must be between 3 and 20
                          path:
                            type: string
                            example: q
                          location:
                            type: string
                            example: query
    post:
      tags:
        - events
      summary: Create a new event
      operationId: createEvent
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: Tech Innovation Summit 2027
                description:
                  type: string
                  example: A conference exploring emerging technologies and innovation trends.
                location_text:
                  type: string
                  example: 123 Main Street, San Francisco, CA
                start_at:
                  type: string
                  format: date-time
                  example: 2025-12-06T11:49:27.918Z
                end_at:
                  type: string
                  format: date-time
                  example: 2025-12-06T11:49:28.918Z
                price_cents:
                  type: integer
                  example: 2500
                capacity:
                  type: integer
                  example: 150
      responses:
        '200':
          description: Event created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event created successfully
                  result:
                    $ref: '#/components/schemas/Event'

        '403':
          description: Must be organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'Must be organizer'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      price_cents:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          msg:
                            type: string
                            example: Event's price is required
                          path:
                            type: string
                            example: price_cents
                          location:
                            type: string
                            example: body
  /api/v1/events/{event_id}:
    get:
      tags:
        - events
      summary: Get published event by ID
      operationId: getEventById
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the event to retrieve
          example: 406347ea-6902-4983-87cb-d67e4628dbfd
      responses:
        '200':
          description: Get event successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get events successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: 406347ea-6902-4983-87cb-d67e4628dbfd
                      organizer_name:
                        type: string
                        example: Tran Ngoc Thao Vy
                      title:
                        type: string
                        example: Implemented leading edge strategy
                      description:
                        type: string
                        example: >
                          Cerno volva adulatio pecus deprimo synagoga thymum aranea defleo.
                          Maiores venio cariosus vallum velut acsi accusator substantia.
                          Expedita repellat aestivus.
                      poster_url:
                        type: string
                        format: uri
                        example: https://picsum.photos/seed/Nn7peLXM/800/600?grayscale&blur=4
                      location_text:
                        type: string
                        example: Lake Mikeboro, Austria
                      start_at:
                        type: string
                        format: date-time
                        example: 2025-12-06T11:49:27.909Z
                      end_at:
                        type: string
                        format: date-time
                        example: 2025-12-10T15:30:04.593Z
                      price_cents:
                        type: integer
                        example: 16583
                      checked_in:
                        type: integer
                        example: 48
                      capacity:
                        type: integer
                        example: 176
                      status:
                        type: string
                        example: published

        '409':
          description: Event poster only allowed on draft
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event poster only allowed on draft
        '403':
          description: Current user is not event's organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Current user is not event's organizer"
    patch:
      tags:
        - events
      summary: Update an event by ID
      operationId: updateEventById
      security:
        - BearerAuth: []
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the event to update
          example: a29a9e03-ba2a-4ed0-8262-ed9d32d89b3b
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: Updated event title
                description:
                  type: string
                  example: A conference exploring emerging technologies and innovation trends.
                location_text:
                  type: string
                  example: 123 Main Street, San Francisco, CA
                start_at:
                  type: string
                  format: date-time
                  example: 2025-11-20T09:00:00Z
                end_at:
                  type: string
                  format: date-time
                  example: 2025-11-20T17:00:00Z
                price_cents:
                  type: integer
                  example: 2500
                capacity:
                  type: integer
                  example: 150

      responses:
        '200':
          description: Update event successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Update event successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: a29a9e03-ba2a-4ed0-8262-ed9d32d89b3b
                      title:
                        type: string
                        example: Updated event's details
                      description:
                        type: string
                        example: A conference exploring emerging technologies and innovation trends.
                      poster_url:
                        type: string
                        format: uri
                        example: https://picsum.photos/seed/8gkZD9lo4/800/600?grayscale&blur=6
                      location_text:
                        type: string
                        example: 123 Main Street, San Francisco, CA
                      start_at:
                        type: string
                        format: date-time
                        example: 2025-11-20T09:00:00.000Z
                      end_at:
                        type: string
                        format: date-time
                        example: 2025-11-20T17:00:00.000Z
                      price_cents:
                        type: integer
                        example: 2500
                      checked_in:
                        type: integer
                        example: 27
                      capacity:
                        type: integer
                        example: 150
                      status:
                        type: string
                        example: draft

        '409':
          description: Change event only allowed on draft
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Change event only allowed on draft

        '403':
          description: Current user is not event's organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Current user is not event's organizer"

        '404':
          description: Event not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event not found
  /api/v1/events/{event_id}/messages:
    post:
      tags:
        - events
      summary: Send message to event attendees
      operationId: sendMessageToEventAttendees
      security:
        - BearerAuth: []
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the event to send message
          example: 084bc4e5-8fe0-4394-a85d-1e65ed3dae16
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
                  example: Xin chao mng
      responses:
        '200':
          description: Create event message successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get event messages successfully
                  result:
                    $ref: '#/components/schemas/EventMessage'

        '403':
          description: Current user is not event's attendee or organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Current user is not event's attendee or organizer"
    get:
      tags:
        - events
      summary: Get event messages
      operationId: getEventMessages
      security:
        - BearerAuth: []
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the event to get messages
          example: 084bc4e5-8fe0-4394-a85d-1e65ed3dae16
        - name: limit
          in: query
          required: true
          schema:
            type: integer
            default: 20
          description: Number of items per page
        - name: page
          in: query
          required: true
          schema:
            type: integer
            default: 1
          description: Page number
      responses:
        '200':
          description: Get event messages successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get event messages successfully
                  result:
                    type: object
                    properties:
                      messages:
                        type: array
                        items:
                          $ref: '#/components/schemas/EventMessage'
                      limit:
                        type: integer
                        example: 20
                      page:
                        type: integer
                        example: 1
                      total_page:
                        type: integer
                        example: 3

        '403':
          description: Current user is not event's attendee or organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Current user is not event's attendee or organizer"
  /api/v1/events/{event_id}/poster:
    put:
      tags:
        - events
      summary: Update event's poster image
      operationId: updateEventPoster
      security:
        - BearerAuth: []
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the event to update poster
          example: a29a9e03-ba2a-4ed0-8262-ed9d32d89b3b
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                image:
                  type: string
                  format: binary
      responses:
        '200':
          description: Upload event poster successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Upload event poster successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: a29a9e03-ba2a-4ed0-8262-ed9d32d89b3b
                      title:
                        type: string
                        example: Updated event's details
                      description:
                        type: string
                        example: A conference exploring emerging technologies and innovation trends.
                      poster_url:
                        type: string
                        format: uri
                        example: https://mivora-ap-southeast-1.s3.ap-southeast-1.amazonaws.com/avatar-images/chy2p6xp44t0yesln51zjfngc.jpg
                      location_text:
                        type: string
                        example: 123 Main Street, San Francisco, CA
                      start_at:
                        type: string
                        format: date-time
                        example: 2025-11-20T09:00:00.000Z
                      end_at:
                        type: string
                        format: date-time
                        example: 2025-11-20T17:00:00.000Z
                      price_cents:
                        type: integer
                        example: 2500
                      checked_in:
                        type: integer
                        example: 27
                      capacity:
                        type: integer
                        example: 150
                      status:
                        type: string
                        example: draft

        '403':
          description: Current user is not event's organizer
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Current user is not event's organizer"
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event not found
  /api/v1/events/{event_id}/status:
    patch:
      tags:
        - events
      summary: Update event status
      operationId: updateEventStatus
      security:
        - BearerAuth: []
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID of the event to update
          example: 74ef51f2-65a5-4df3-90f4-d703dc0aab0e
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [published, canceled, draft]
                  example: published
              required: [status]
      responses:
        '200':
          description: Change event status successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Change event status successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: 74ef51f2-65a5-4df3-90f4-d703dc0aab0e
                      title:
                        type: string
                        example: Universal cohesive help-desk
                      description:
                        type: string
                        example: >
                          Traho arguo tendo tristis quas. Tabella subiungo adicio molestias
                          atrox succedo cribro thymbra aptus. Atavus reiciendis caelestis
                          commodi cura creo deputo voluntarius.
                      poster_url:
                        type: string
                        format: uri
                        example: https://picsum.photos/seed/lyclLl9Cj/800/600?blur=8
                      location_text:
                        type: string
                        example: North Kelley, Cambodia
                      start_at:
                        type: string
                        format: date-time
                        example: 2025-12-06T11:49:27.914Z
                      end_at:
                        type: string
                        format: date-time
                        example: 2025-12-16T14:15:26.710Z
                      price_cents:
                        type: integer
                        example: 38526
                      checked_in:
                        type: integer
                        example: 17
                      capacity:
                        type: integer
                        example: 432
                      status:
                        type: string
                        enum: [published, canceled, draft]
                        example: published
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation error
                  errors:
                    type: object
                    properties:
                      status:
                        type: object
                        properties:
                          type:
                            type: string
                            example: field
                          value:
                            type: string
                            example: publishasded
                          msg:
                            type: string
                            example: Event's status must be draft, published, or canceled
                          path:
                            type: string
                            example: status
                          location:
                            type: string
                            example: body

  /api/v1/tickets:
    post:
      tags:
        - ticket
      summary: Book a ticket to an event
      operationId: bookTicket
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                event_id:
                  type: string
                  format: uuid
                  example: ba6e6578-da2d-4317-a605-279f9c207228
      responses:
        '200':
          description: Book ticket successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Book ticket successfully
                  result:
                    type: object
                    properties:
                      ticket:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                            example: c341339e-6277-464a-a35c-7a09184ca600
                          event_title:
                            type: string
                            example: Grass-roots dedicated hierarchy
                          event_status:
                            type: string
                            enum: [booked, canceled, checked_in]
                            example: published
                          ticket_status:
                            type: string
                            enum: [booked, canceled, checked_in]
                            example: booked
                          checked_in_at:
                            type: string
                            format: date-time
                            nullable: true
                            example: null
                          price_cents:
                            type: integer
                            example: 31315
                          qr_code:
                            type: string
                            description: Ticket QR code as data URL (base64 image)
                            example: data:image/png;base64,<base64-data>
        '403':
          description: Event's creator cannot book ticket
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Event's creator cannot book ticket
        '409':
          description: One user per event only
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: One user per event only
  /api/v1/tickets/{ticket_id}:
    get:
      tags:
        - ticket
      summary: Get ticket by ID
      operationId: getTicketById
      security:
        - BearerAuth: []
      parameters:
        - name: ticket_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the ticket to retrieve
          example: c341339e-6277-464a-a35c-7a09184ca600
      responses:
        '200':
          description: Get ticket details successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Get ticket details successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: 625897d7-4440-4dab-9d60-74ac26a8aae9
                      event_title:
                        type: string
                        example: Organic heuristic moderator
                      event_status:
                        type: string
                        enum: [published, draft, canceled]
                        example: published
                      ticket_status:
                        type: string
                        enum: [booked, canceled, checked_in]
                        example: booked
                      checked_in_at:
                        type: string
                        format: date-time
                        nullable: true
                        example: null
                      price_cents:
                        type: integer
                        example: 19286
                      qr_code:
                        type: string
                        description: Base64 QR code image (data URL)
                        example: data:image/png;base64,<base64>
        '403':
          description: Current user is not ticket owner
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Current user is not ticket owner
  /api/v1/tickets/{ticket_id}/status:
    patch:
      tags:
        - ticket
      summary: Check in a ticket by ID
      operationId: checkInTicket
      security:
        - BearerAuth: []
      parameters:
        - name: ticket_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the ticket to check in
          example: c341339e-6277-464a-a35c-7a09184ca600
      responses:
        '200':
          description: Ticket canceled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Ticket canceled successfully
                  result:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: 625897d7-4440-4dab-9d60-74ac26a8aae9
                      event_title:
                        type: string
                        example: Organic heuristic moderator
                      event_status:
                        type: string
                        enum: [published, draft, canceled]
                        example: published
                      ticket_status:
                        type: string
                        enum: [booked, canceled, checked_in]
                        example: canceled
                      checked_in_at:
                        type: string
                        format: date-time
                        nullable: true
                        example: null
                      price_cents:
                        type: integer
                        example: 19286
                      qr_code:
                        type: string
                        description: Base64 QR code image (data URL)
                        example: data:image/png;base64,<base64>

        '403':
          description: Only booked tickets can be canceled
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Only booked tickets can be canceled
  /api/v1/tickets/check-ins:
    post:
      tags:
        - ticket
      summary: Scan (check-in) a ticket by qr_code_token
      operationId: scanTicket
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                qr_code_token:
                  type: string
                  format: uuid
                  example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJldmVudF9pZCI6ImE4ZDI5ZWNkLTAzYWUtNGI2MS1hOThiLTMxYmNjMmY0NGMxNyIsInVzZXJfaWQiOiIwNzk2NWI3Mi0xZDU3LTRkM2EtOWZjYy01MmRjNWRjZGFhMzkiLCJ0b2tlblR5cGUiOjQsImlhdCI6MTc2NDgzMTkyMX0.vPLtSgO0tlyFAzQ_wmsSUudb5M7d9pznYtwKxjYB60I
      responses:
        '200':
          description: Ticket scanned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Ticket scanned successfully
        '404':
          description: Ticket not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Ticket not found
        '403':
          description: Ticket has been checked in already
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Ticket has been checked in already
        '409':
          description: Ticket already checked in
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Ticket already checked in

components:
  schemas:
    LoginBody:
      type: object
      properties:
        email:
          type: string
          example: TNTV10@gmail.com
        password:
          type: string
          example: Thaovy85.
    RegisterBody:
      type: object
      properties:
        name:
          type: string
          example: 'Lam Uyen Phuong'
        email:
          type: string
          example: 'TNTV12@gmail.com'
        password:
          type: string
          example: 'Thaovy85.'
        confirm_password:
          type: string
          example: 'Thaovy85.'
    AuthenticateSuccessfully:
      type: object
      properties:
        result:
          type: object
          properties:
            access_token:
              type: string
              example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MCwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc1MjU4OTk2Nn0.N0NpQZDcu-gMpXLApVimd0etDPJoz7cp6ksGsdbP1WA'
            refresh_token:
              type: string
              example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjg0NmE5MjJjOGQ2YzYwYzI5ZWM5MmQzIiwidG9rZW5fdHlwZSI6MSwidmVyaWZ5IjoxLCJpYXQiOjE3NTI1ODk5MzYsImV4cCI6MTc2MTIyOTkzNn0.C4W_Me1Di-owhrpj1VJ6j-ImoPtWMy6QMPT6R-uJ4a8'
    UserProfile:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 9aaef5a6-f9ea-458b-8e31-58cd9fbd7fa4
        name:
          type: string
          example: Pham Khoi Nguyen
        email:
          type: string
          format: email
          example: TNTV11@gmail.com
        avatar_url:
          type: string
          example: https://mivora-ap-southeast-1.s3.ap-southeast-1.amazonaws.com/avatar-images/l8pwojtt1ingzb8e2vycka40a.jpg
        role:
          type: array
          items:
            type: string
            enum: [attendee]
          example:
            - attendee
            - organizer
    UpdateUserRequest:
      type: object
      required: [name, role]
      properties:
        name:
          type: string
          example: Pham Khoi Nguyen
        role:
          type: string
          enum: [attendee, organizer]
          example: organizer
    Event:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 6a2f69f9-321b-4c73-adc5-eba50c761bdc
        title:
          type: string
          example: Tech Innovation Summit 2027
        description:
          type: string
          example: A conference exploring emerging technologies and innovation trends.
        poster_url:
          type: string
          format: uri
          example: https://mivora-ap-southeast-1.s3.ap-southeast-1.amazonaws.com/avatar-images/gfu4o33ca43nvcwyv4vay18m1.jpg
        location_text:
          type: string
          example: 123 Main Street, San Francisco, CA
        start_at:
          type: string
          format: date-time
          example: 2025-12-06T11:49:27.918Z
        end_at:
          type: string
          format: date-time
          example: 2025-12-06T11:49:28.918Z
        price_cents:
          type: integer
          example: 2500
        checked_in:
          type: integer
          example: 0
        capacity:
          type: integer
          example: 150
        status:
          type: string
          example: draft
    EventMessagesResult:
      type: object
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/EventMessage'
        limit:
          type: integer
        page:
          type: integer
        total_page:
          type: integer
        total_count:
          type: integer
      required:
        - messages
        - limit
        - page
        - total_page
        - total_count

    EventMessage:
      type: object
      properties:
        id:
          type: string
          format: uuid
        content:
          type: string
        created_at:
          type: string
          format: date-time
        user_id:
          type: string
          format: uuid
        user_name:
          type: string
        user_avatar_url:
          type: string
          format: uri
      required:
        - id
        - content
        - created_at
        - user_id
        - user_name
        - user_avatar_url
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Use the `Bearer` scheme to authenticate requests. Include the token in the `Authorization` header as follows:
        ```
        Authorization: Bearer <your_token>
        ```
